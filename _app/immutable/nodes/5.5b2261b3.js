import{s as H,h as z}from"../chunks/scheduler.d43faf19.js";import{S as J,i as X,e as O,a as h,d,t as p,b as E,f as b,g as w,m as T,s as $,h as L,j as N,n as y,c as P,k as g,C as v,o as F,p as S,D as G,r as D,u as I,v as q,w as B}from"../chunks/index.fe9cecfd.js";import{L as K,X as M}from"../chunks/Loader2.32120813.js";import{g as Q}from"../chunks/navigation.4206130a.js";import{c as k}from"../chunks/i18n.d26827e2.js";function j(u){let e,s,t=(u[0]!="done"?k("unsubscribe.title"):k("unsubscribe.title2"))+"",l,o,r,i=u[0]!="done"&&C(u);return{c(){e=w("section"),s=w("h2"),l=T(t),o=$(),i&&i.c(),this.h()},l(c){e=L(c,"SECTION",{class:!0});var n=N(e);s=L(n,"H2",{});var a=N(s);l=y(a,t),a.forEach(b),o=P(n),i&&i.l(n),n.forEach(b),this.h()},h(){g(e,"class","svelte-1gzn7st")},m(c,n){h(c,e,n),v(e,s),v(s,l),v(e,o),i&&i.m(e,null),r=!0},p(c,n){(!r||n&1)&&t!==(t=(c[0]!="done"?k("unsubscribe.title"):k("unsubscribe.title2"))+"")&&F(l,t),c[0]!="done"?i?(i.p(c,n),n&1&&d(i,1)):(i=C(c),i.c(),d(i,1),i.m(e,null)):i&&(S(),p(i,1,1,()=>{i=null}),E())},i(c){r||(d(i),r=!0)},o(c){p(i),r=!1},d(c){c&&b(e),i&&i.d()}}}function C(u){let e,s,t,l,o,r,i,c,n=u[0]=="initial"&&R(),a=u[0]=="loading"&&U(),f=u[0]=="error"&&A();return{c(){e=w("button"),n&&n.c(),s=$(),a&&a.c(),t=$(),f&&f.c(),this.h()},l(_){e=L(_,"BUTTON",{class:!0,title:!0});var m=N(e);n&&n.l(m),s=P(m),a&&a.l(m),t=P(m),f&&f.l(m),m.forEach(b),this.h()},h(){g(e,"class",l=z(u[0])+" svelte-1gzn7st"),e.disabled=o=u[0]!=="initial",g(e,"title",u[1])},m(_,m){h(_,e,m),n&&n.m(e,null),v(e,s),a&&a.m(e,null),v(e,t),f&&f.m(e,null),r=!0,i||(c=G(e,"click",u[3]),i=!0)},p(_,m){_[0]=="initial"?n||(n=R(),n.c(),n.m(e,s)):n&&(n.d(1),n=null),_[0]=="loading"?a?m&1&&d(a,1):(a=U(),a.c(),d(a,1),a.m(e,t)):a&&(S(),p(a,1,1,()=>{a=null}),E()),_[0]=="error"?f?m&1&&d(f,1):(f=A(),f.c(),d(f,1),f.m(e,null)):f&&(S(),p(f,1,1,()=>{f=null}),E()),(!r||m&1&&l!==(l=z(_[0])+" svelte-1gzn7st"))&&g(e,"class",l),(!r||m&1&&o!==(o=_[0]!=="initial"))&&(e.disabled=o),(!r||m&2)&&g(e,"title",_[1])},i(_){r||(d(a),d(f),r=!0)},o(_){p(a),p(f),r=!1},d(_){_&&b(e),n&&n.d(),a&&a.d(),f&&f.d(),i=!1,c()}}}function R(u){let e=k("unsubscribe.button")+"",s;return{c(){s=T(e)},l(t){s=y(t,e)},m(t,l){h(t,s,l)},d(t){t&&b(s)}}}function U(u){let e,s,t;return s=new K({}),{c(){e=w("loader"),D(s.$$.fragment),this.h()},l(l){e=L(l,"LOADER",{class:!0});var o=N(e);I(s.$$.fragment,o),o.forEach(b),this.h()},h(){g(e,"class","svelte-1gzn7st")},m(l,o){h(l,e,o),q(s,e,null),t=!0},i(l){t||(d(s.$$.fragment,l),t=!0)},o(l){p(s.$$.fragment,l),t=!1},d(l){l&&b(e),B(s)}}}function A(u){let e,s,t=k("general.error")+"",l,o;return e=new M({props:{class:"icon"}}),{c(){D(e.$$.fragment),s=$(),l=T(t)},l(r){I(e.$$.fragment,r),s=P(r),l=y(r,t)},m(r,i){q(e,r,i),h(r,s,i),h(r,l,i),o=!0},i(r){o||(d(e.$$.fragment,r),o=!0)},o(r){p(e.$$.fragment,r),o=!1},d(r){r&&(b(s),b(l)),B(e,r)}}}function V(u){let e,s,t=u[2]&&j(u);return{c(){t&&t.c(),e=O()},l(l){t&&t.l(l),e=O()},m(l,o){t&&t.m(l,o),h(l,e,o),s=!0},p(l,[o]){l[2]?t?(t.p(l,o),o&4&&d(t,1)):(t=j(l),t.c(),d(t,1),t.m(e.parentNode,e)):t&&(S(),p(t,1,1,()=>{t=null}),E())},i(l){s||(d(t),s=!0)},o(l){p(t),s=!1},d(l){l&&b(e),t&&t.d(l)}}}function W(u,e,s){const t="https://jerrygreen.deno.dev";let{data:l}=e,o="initial",r,i;typeof window<"u"&&(i=new URLSearchParams(location.search).get("token")||"",i||(console.warn("No token provided, redirecting..."),Q("/")));async function c(){i&&(s(0,o="loading"),fetch(`${t}/unsubscribe?token=${i}`).then(n=>{n.ok||(console.error(`Encountered error: {res.status} ${n.statusText}`),s(0,o="error"),s(1,r=n.statusText)),n.text().then(a=>{console.info(n.url,a);const f=JSON.parse(a);f.status!=200?(console.error(`Encountered error (${f.status}): ${f.message}`),s(0,o="error"),s(1,r=f.message)):s(0,o="done")})}))}return u.$$set=n=>{"data"in n&&s(4,l=n.data)},u.$$.update=()=>{u.$$.dirty&3&&s(1,r=["error","done"].includes(o)&&r||"")},[o,r,i,c,l]}class le extends J{constructor(e){super(),X(this,e,W,V,H,{data:4})}}export{le as component};
